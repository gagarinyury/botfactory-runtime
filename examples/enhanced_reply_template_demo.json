{
  "use": [
    "flow.wizard.v1",
    "action.sql_query.v1",
    "action.reply_template.v1"
  ],
  "intents": [
    {"cmd": "/start", "reply": "–î–æ–±—Ä–æ –ø–æ–∂–∞–ª–æ–≤–∞—Ç—å! –î–æ—Å—Ç—É–ø–Ω—ã–µ –∫–æ–º–∞–Ω–¥—ã: /menu, /profile, /orders"}
  ],
  "flows": [
    {
      "type": "flow.wizard.v1",
      "entry_cmd": "/menu",
      "params": {
        "on_enter": [
          {
            "type": "action.reply_template.v1",
            "params": {
              "text": "üè† <b>–ì–ª–∞–≤–Ω–æ–µ –º–µ–Ω—é</b>\n\n–í—ã–±–µ—Ä–∏—Ç–µ –¥–µ–π—Å—Ç–≤–∏–µ –∏–∑ —Å–ø–∏—Å–∫–∞ –Ω–∏–∂–µ:",
              "parse_mode": "HTML",
              "keyboard": [
                [
                  {"text": "üë§ –ü—Ä–æ—Ñ–∏–ª—å", "callback": "/profile"},
                  {"text": "üì¶ –ó–∞–∫–∞–∑—ã", "callback": "/orders"}
                ],
                [
                  {"text": "üõí –ö–∞—Ç–∞–ª–æ–≥", "callback": "/catalog"},
                  {"text": "üí¨ –ü–æ–¥–¥–µ—Ä–∂–∫–∞", "callback": "/support"}
                ],
                {"text": "‚ÑπÔ∏è –û –∫–æ–º–ø–∞–Ω–∏–∏", "callback": "/about"}
              ]
            }
          }
        ]
      }
    },
    {
      "type": "flow.wizard.v1",
      "entry_cmd": "/profile",
      "params": {
        "steps": [
          {
            "ask": "–ö–∞–∫ –≤–∞—Å –∑–æ–≤—É—Ç?",
            "var": "username"
          }
        ],
        "on_complete": [
          {
            "type": "action.reply_template.v1",
            "params": {
              "text": "t:profile.greeting {name={{username}}}",
              "parse_mode": "MarkdownV2",
              "keyboard": [
                [
                  {"text": "‚úèÔ∏è –ò–∑–º–µ–Ω–∏—Ç—å –∏–º—è", "callback": "/edit_name"},
                  {"text": "üîô –í –º–µ–Ω—é", "callback": "/menu"}
                ]
              ]
            }
          }
        ]
      }
    },
    {
      "type": "flow.wizard.v1",
      "entry_cmd": "/orders",
      "params": {
        "on_enter": [
          {
            "type": "action.sql_query.v1",
            "params": {
              "sql": "SELECT id, product_name, to_char(created_at,'YYYY-MM-DD') AS order_date, status, total_amount FROM orders WHERE bot_id=:bot_id AND user_id=:user_id ORDER BY created_at DESC LIMIT 10",
              "result_var": "user_orders"
            }
          },
          {
            "type": "action.reply_template.v1",
            "params": {
              "text": "üì¶ *–í–∞—à–∏ –∑–∞–∫–∞–∑—ã:*\n\n{{#each user_orders}}üìã *–ó–∞–∫–∞–∑ #{{id}}*\n‚Ä¢ {{product_name}}\n‚Ä¢ {{order_date}} \\| {{status}}\n‚Ä¢ {{total_amount}}‚ÇΩ\n\n{{/each}}",
              "empty_text": "üì≠ *–£ –≤–∞—Å –ø–æ–∫–∞ –Ω–µ—Ç –∑–∞–∫–∞–∑–æ–≤*\n\n–í—ã –º–æ–∂–µ—Ç–µ –æ—Ñ–æ—Ä–º–∏—Ç—å –ø–µ—Ä–≤—ã–π –∑–∞–∫–∞–∑ –≤ –Ω–∞—à–µ–º –∫–∞—Ç–∞–ª–æ–≥–µ\\!",
              "parse_mode": "MarkdownV2",
              "keyboard": [
                [
                  {"text": "üõí –ü–µ—Ä–µ–π—Ç–∏ –∫ –ø–æ–∫—É–ø–∫–∞–º", "callback": "/catalog"},
                  {"text": "üîç –ü–æ–∏—Å–∫ –∑–∞–∫–∞–∑–∞", "callback": "/search_order"}
                ],
                {"text": "üîô –ù–∞–∑–∞–¥ –≤ –º–µ–Ω—é", "callback": "/menu"}
              ]
            }
          }
        ]
      }
    },
    {
      "type": "flow.wizard.v1",
      "entry_cmd": "/catalog",
      "params": {
        "on_enter": [
          {
            "type": "action.sql_query.v1",
            "params": {
              "sql": "SELECT id, name, price, category, in_stock FROM products WHERE bot_id=:bot_id AND active=true ORDER BY category, name LIMIT 20",
              "result_var": "products"
            }
          },
          {
            "type": "action.reply_template.v1",
            "params": {
              "text": "üõí <b>–ö–∞—Ç–∞–ª–æ–≥ —Ç–æ–≤–∞—Ä–æ–≤</b>\n\n{{#each products}}üè∑Ô∏è <b>{{name}}</b>\nüí∞ {{price}}‚ÇΩ | üìÇ {{category}}\n{{#if in_stock}}‚úÖ –í –Ω–∞–ª–∏—á–∏–∏{{else}}‚ùå –ù–µ—Ç –≤ –Ω–∞–ª–∏—á–∏–∏{{/if}}\n\n{{/each}}",
              "empty_text": "üö´ <b>–ö–∞—Ç–∞–ª–æ–≥ –≤—Ä–µ–º–µ–Ω–Ω–æ –ø—É—Å—Ç</b>\n\n–ú—ã —Ä–∞–±–æ—Ç–∞–µ–º –Ω–∞–¥ –¥–æ–±–∞–≤–ª–µ–Ω–∏–µ–º –Ω–æ–≤—ã—Ö —Ç–æ–≤–∞—Ä–æ–≤.",
              "parse_mode": "HTML",
              "keyboard": [
                [
                  {"text": "üì± –≠–ª–µ–∫—Ç—Ä–æ–Ω–∏–∫–∞", "callback": "cat:electronics"},
                  {"text": "üëï –û–¥–µ–∂–¥–∞", "callback": "cat:clothing"}
                ],
                [
                  {"text": "üìö –ö–Ω–∏–≥–∏", "callback": "cat:books"},
                  {"text": "üè† –î–ª—è –¥–æ–º–∞", "callback": "cat:home"}
                ],
                [
                  {"text": "üîç –ü–æ–∏—Å–∫", "callback": "/search"},
                  {"text": "üõçÔ∏è –ö–æ—Ä–∑–∏–Ω–∞", "callback": "/cart"}
                ],
                {"text": "üîô –ù–∞–∑–∞–¥", "callback": "/menu"}
              ]
            }
          }
        ]
      }
    },
    {
      "type": "flow.wizard.v1",
      "entry_cmd": "/support",
      "params": {
        "on_enter": [
          {
            "type": "action.reply_template.v1",
            "params": {
              "text": "üí¨ <b>–°–ª—É–∂–±–∞ –ø–æ–¥–¥–µ—Ä–∂–∫–∏</b>\n\n<i>–ú—ã –≥–æ—Ç–æ–≤—ã –ø–æ–º–æ—á—å –≤–∞–º 24/7!</i>\n\n–í—ã–±–µ—Ä–∏—Ç–µ —Å–ø–æ—Å–æ–± —Å–≤—è–∑–∏:",
              "parse_mode": "HTML",
              "keyboard": [
                [
                  {"text": "üìû –ü–æ–∑–≤–æ–Ω–∏—Ç—å", "callback": "support:call"},
                  {"text": "‚úâÔ∏è Email", "callback": "support:email"}
                ],
                [
                  {"text": "üí¨ –ß–∞—Ç", "callback": "support:chat"},
                  {"text": "‚ùì FAQ", "callback": "support:faq"}
                ],
                {"text": "üîô –ù–∞–∑–∞–¥", "callback": "/menu"}
              ]
            }
          }
        ]
      }
    },
    {
      "type": "flow.wizard.v1",
      "entry_cmd": "/about",
      "params": {
        "on_enter": [
          {
            "type": "action.sql_query.v1",
            "params": {
              "sql": "SELECT COUNT(*) as total_users, COUNT(DISTINCT DATE(created_at)) as active_days FROM users WHERE bot_id=:bot_id",
              "result_var": "stats",
              "scalar": false
            }
          },
          {
            "type": "action.reply_template.v1",
            "params": {
              "text": "‚ÑπÔ∏è *–û –Ω–∞—à–µ–π –∫–æ–º–ø–∞–Ω–∏–∏*\n\nüè¢ *BotFactory Ltd\\.*\nüìç –ú–æ—Å–∫–≤–∞, –†–æ—Å—Å–∏—è\nüìÖ –û—Å–Ω–æ–≤–∞–Ω–∞ –≤ 2024 –≥–æ–¥—É\n\nüìä *–ù–∞—à–∞ —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞:*\n{{#each stats}}üë• –ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π: {{total_users}}\nüìà –ê–∫—Ç–∏–≤–Ω—ã—Ö –¥–Ω–µ–π: {{active_days}}{{/each}}\n\nüéØ *–ú–∏—Å—Å–∏—è:* –°–æ–∑–¥–∞–≤–∞—Ç—å –ª—É—á—à–∏–µ –±–æ—Ç—ã –¥–ª—è –≤–∞—à–µ–≥–æ –±–∏–∑–Ω–µ—Å–∞\\!\n\nüíº *–£—Å–ª—É–≥–∏:*\n‚Ä¢ –†–∞–∑—Ä–∞–±–æ—Ç–∫–∞ —á–∞—Ç\\-–±–æ—Ç–æ–≤\n‚Ä¢ –ò–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è —Å CRM\n‚Ä¢ –¢–µ—Ö–Ω–∏—á–µ—Å–∫–∞—è –ø–æ–¥–¥–µ—Ä–∂–∫–∞\n‚Ä¢ –ö–æ–Ω—Å—É–ª—å—Ç–∞—Ü–∏–∏ –ø–æ –∞–≤—Ç–æ–º–∞—Ç–∏–∑–∞—Ü–∏–∏",
              "parse_mode": "MarkdownV2",
              "keyboard": [
                [
                  {"text": "üåê –°–∞–π—Ç", "callback": "link:website"},
                  {"text": "üìß –ö–æ–Ω—Ç–∞–∫—Ç—ã", "callback": "link:contacts"}
                ],
                [
                  {"text": "üíº –£—Å–ª—É–≥–∏", "callback": "/services"},
                  {"text": "üìã –ü–æ—Ä—Ç—Ñ–æ–ª–∏–æ", "callback": "/portfolio"}
                ],
                {"text": "üîô –í –≥–ª–∞–≤–Ω–æ–µ –º–µ–Ω—é", "callback": "/menu"}
              ]
            }
          }
        ]
      }
    },
    {
      "type": "flow.wizard.v1",
      "entry_cmd": "/calculator",
      "params": {
        "on_enter": [
          {
            "type": "action.reply_template.v1",
            "params": {
              "text": "üßÆ *–ö–∞–ª—å–∫—É–ª—è—Ç–æ—Ä*\n\n–í–≤–µ–¥–∏—Ç–µ –≤—ã—Ä–∞–∂–µ–Ω–∏–µ –∏–ª–∏ –∏—Å–ø–æ–ª—å–∑—É–π—Ç–µ –∫–Ω–æ–ø–∫–∏:",
              "parse_mode": "MarkdownV2",
              "keyboard": [
                [
                  {"text": "7", "callback": "calc:7"},
                  {"text": "8", "callback": "calc:8"},
                  {"text": "9", "callback": "calc:9"},
                  {"text": "√∑", "callback": "calc:div"}
                ],
                [
                  {"text": "4", "callback": "calc:4"},
                  {"text": "5", "callback": "calc:5"},
                  {"text": "6", "callback": "calc:6"},
                  {"text": "√ó", "callback": "calc:mul"}
                ],
                [
                  {"text": "1", "callback": "calc:1"},
                  {"text": "2", "callback": "calc:2"},
                  {"text": "3", "callback": "calc:3"},
                  {"text": "+", "callback": "calc:add"}
                ],
                [
                  {"text": "0", "callback": "calc:0"},
                  {"text": ".", "callback": "calc:dot"},
                  {"text": "=", "callback": "calc:equals"},
                  {"text": "‚àí", "callback": "calc:sub"}
                ],
                [
                  {"text": "üóëÔ∏è –û—á–∏—Å—Ç–∏—Ç—å", "callback": "calc:clear"},
                  {"text": "‚å´ –£–¥–∞–ª–∏—Ç—å", "callback": "calc:backspace"}
                ],
                {"text": "üîô –í—ã—Ö–æ–¥", "callback": "/menu"}
              ]
            }
          }
        ]
      }
    }
  ]
}