# Bot Factory Runtime

ü§ñ **–ú—É–ª—å—Ç–∏—Ç–µ–Ω–∞–Ω—Ç–Ω–∞—è —Å–∏—Å—Ç–µ–º–∞ –¥–ª—è —Å–æ–∑–¥–∞–Ω–∏—è –∏ —É–ø—Ä–∞–≤–ª–µ–Ω–∏—è Telegram –±–æ—Ç–∞–º–∏**

‚ú® **–û—Å–æ–±–µ–Ω–Ω–æ—Å—Ç–∏:**
- üöÄ **Hot Reload** - –∏–∑–º–µ–Ω–µ–Ω–∏—è –ø—Ä–∏–º–µ–Ω—è—é—Ç—Å—è –º–≥–Ω–æ–≤–µ–Ω–Ω–æ –±–µ–∑ –ø–µ—Ä–µ–∑–∞–ø—É—Å–∫–∞
- üéØ **–ú—É–ª—å—Ç–∏—Ç–µ–Ω–∞–Ω—Ç–Ω–æ—Å—Ç—å** - –Ω–µ–æ–≥—Ä–∞–Ω–∏—á–µ–Ω–Ω–æ–µ –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ –±–æ—Ç–æ–≤ –Ω–∞ –æ–¥–Ω–æ–º —Å–µ—Ä–≤–µ—Ä–µ
- ‚ö° **–ù–µ–∑–∞–≤–∏—Å–∏–º–æ—Å—Ç—å** - –∫–∞–∂–¥—ã–π –±–æ—Ç –∏–º–µ–µ—Ç —Å–≤–æ—é –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—é –∏ –∫–æ–º–∞–Ω–¥—ã
- üîß **–ü—Ä–æ—Å—Ç–æ—Ç–∞** - —Å–æ–∑–¥–∞–Ω–∏–µ –±–æ—Ç–∞ —á–µ—Ä–µ–∑ REST API –∑–∞ –º–∏–Ω—É—Ç—É

## üöÄ –ë—ã—Å—Ç—Ä—ã–π —Å—Ç–∞—Ä—Ç

```bash
# 1. –ó–∞–ø—É—Å–∫ —Å–∏—Å—Ç–µ–º—ã
docker-compose up -d

# 2. –ü—Ä–æ–≤–µ—Ä–∫–∞ —Ä–∞–±–æ—Ç–æ—Å–ø–æ—Å–æ–±–Ω–æ—Å—Ç–∏
curl http://localhost:8000/health

# 3. –°–æ–∑–¥–∞–Ω–∏–µ –ø–µ—Ä–≤–æ–≥–æ –±–æ—Ç–∞
curl -X POST 'http://localhost:8000/bots' \
  -H 'Content-Type: application/json' \
  -d '{"name": "MyBot", "token": "YOUR_BOT_TOKEN_FROM_BOTFATHER"}'
```

**üìñ –ü–æ–ª–Ω–∞—è –∏–Ω—Å—Ç—Ä—É–∫—Ü–∏—è:** [HOW_TO_CREATE_BOTS.md](./HOW_TO_CREATE_BOTS.md)

## ü§ñ –ü—Ä–∏–º–µ—Ä—ã —Ä–∞–±–æ—Ç–∞—é—â–∏—Ö –±–æ—Ç–æ–≤

| –ë–æ—Ç | Username | –§—É–Ω–∫—Ü–∏–∏ |
|-----|----------|---------|
| BusinessAssistant Pro | [@BusinessAssistantProBot](https://t.me/BusinessAssistantProBot) | `/start`, `/help`, `/status` |
| Terminal Bot | [@terminalv_bot](https://t.me/terminalv_bot) | `/start`, `/help`, `/status`, `/test` |

## üìÅ –°—Ç—Ä—É–∫—Ç—É—Ä–∞ –ø—Ä–æ–µ–∫—Ç–∞

```
runtime/
  main.py           # ‚úÖ FastAPI: /health, /tg/{bot_id}, webhook processing
  loader.py         # –∑–∞–≥—Ä—É–∑–∫–∞ –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏–∏ –±–æ—Ç–æ–≤ –∏–∑ –ë–î
  registry.py       # CRUD –æ–ø–µ—Ä–∞—Ü–∏–∏ —Å –±–æ—Ç–∞–º–∏
  dsl_engine.py     # –¥–∏–Ω–∞–º–∏—á–µ—Å–∫–∞—è —Å–±–æ—Ä–∫–∞ aiogram —Ä–æ—É—Ç–µ—Ä–æ–≤
  management_api.py # API –¥–ª—è —Å–æ–∑–¥–∞–Ω–∏—è –∏ —É–ø—Ä–∞–≤–ª–µ–Ω–∏—è –±–æ—Ç–∞–º–∏
  wizard_engine.py  # –æ–±—Ä–∞–±–æ—Ç–∫–∞ –∫–æ–º–∞–Ω–¥ –∏ flows
  telemetry.py      # /metrics –¥–ª—è –º–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥–∞
migrations/         # –º–∏–≥—Ä–∞—Ü–∏–∏ PostgreSQL
docker/            # Docker –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è
```

## üîß –ö–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è

```bash
# –ü–µ—Ä–µ–º–µ–Ω–Ω—ã–µ –æ–∫—Ä—É–∂–µ–Ω–∏—è (–≤ docker-compose.yml)
DATABASE_URL=postgresql+psycopg://dev:dev@pg:5432/botfactory
REDIS_URL=redis://redis:6379/0
```

## üìö API Endpoints

| –ú–µ—Ç–æ–¥ | Endpoint | –û–ø–∏—Å–∞–Ω–∏–µ |
|-------|----------|----------|
| `GET` | `/health` | –ü—Ä–æ–≤–µ—Ä–∫–∞ —Ä–∞–±–æ—Ç–æ—Å–ø–æ—Å–æ–±–Ω–æ—Å—Ç–∏ |
| `GET` | `/bots` | **–ù–û–í–´–ô** –°–ø–∏—Å–æ–∫ –≤—Å–µ—Ö –±–æ—Ç–æ–≤ |
| `POST` | `/bots` | –°–æ–∑–¥–∞—Ç—å –Ω–æ–≤–æ–≥–æ –±–æ—Ç–∞ |
| `GET` | `/bots/{id}` | –ò–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è –æ –±–æ—Ç–µ |
| `PUT` | `/bots/{id}/spec` | –û–±–Ω–æ–≤–∏—Ç—å –∫–æ–º–∞–Ω–¥—ã –±–æ—Ç–∞ |
| `GET` | `/bots/{id}/spec` | **–ù–û–í–´–ô** –ü–æ–ª—É—á–∏—Ç—å DSL —Å–ø–µ—Ü–∏—Ñ–∏–∫–∞—Ü–∏—é |
| `DELETE` | `/bots/{id}` | **–ù–û–í–´–ô** –£–¥–∞–ª–∏—Ç—å –±–æ—Ç–∞ |
| `DELETE` | `/bots/{id}/data` | **–ù–û–í–´–ô** –û—á–∏—Å—Ç–∏—Ç—å –¥–∞–Ω–Ω—ã–µ –±–æ—Ç–∞ |
| `POST` | `/bots/{id}/validate` | **–ù–û–í–´–ô** –í–∞–ª–∏–¥–∞—Ü–∏—è DSL |
| `POST` | `/bots/{id}/reload` | –ü–µ—Ä–µ–∑–∞–≥—Ä—É–∑–∏—Ç—å –∫—ç—à |
| `POST` | `/tg/{id}` | Webhook –¥–ª—è Telegram |
| `GET` | `/docs` | Swagger –¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è |

## üõ†Ô∏è –†–∞–∑—Ä–∞–±–æ—Ç–∫–∞

```bash
# –£—Å—Ç–∞–Ω–æ–≤–∫–∞ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–µ–π
pip install -e .

# –ó–∞–ø—É—Å–∫ (—Å hot reload)
uvicorn runtime.main:app --reload --host 0.0.0.0 --port 8000

# –¢–µ—Å—Ç—ã
pytest
```

## üéØ –°–æ–∑–¥–∞–Ω–∏–µ –Ω–æ–≤–æ–≥–æ –±–æ—Ç–∞ (–±—ã—Å—Ç—Ä–æ)

```bash
# 1. –ü–æ–ª—É—á–∏—Ç–µ —Ç–æ–∫–µ–Ω –æ—Ç @BotFather
# 2. –°–æ–∑–¥–∞–π—Ç–µ –±–æ—Ç–∞:
curl -X POST 'http://localhost:8000/bots' \
  -H 'Content-Type: application/json' \
  -d '{"name": "QuickBot", "token": "YOUR_TOKEN"}'

# 3. –î–æ–±–∞–≤—å—Ç–µ –∫–æ–º–∞–Ω–¥—ã:
curl -X PUT 'http://localhost:8000/bots/BOT_ID/spec' \
  -H 'Content-Type: application/json' \
  -d '{
    "flows": [
      {"entry_cmd": "/start", "steps": [{"reply": "–ü—Ä–∏–≤–µ—Ç! üëã"}]},
      {"entry_cmd": "/help", "steps": [{"reply": "–î–æ—Å—Ç—É–ø–Ω—ã–µ –∫–æ–º–∞–Ω–¥—ã: /start, /help"}]}
    ]
  }'

# 4. –ù–∞—Å—Ç—Ä–æ–π—Ç–µ webhook –∏ –≥–æ—Ç–æ–≤–æ!
```

## üñ•Ô∏è –ü—Ä–æ–¥–∞–∫—à–Ω

- **–°–µ—Ä–≤–µ—Ä:** https://profy.top/bot/
- **SSH:** `server2`
- **–ú–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥:** `/metrics`
- **–î–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è —Å–µ—Ä–≤–µ—Ä–∞:** [SERVER.md](./SERVER.md)