# ü§ñ –ö–∞–∫ —Å–æ–∑–¥–∞–≤–∞—Ç—å –±–æ—Ç–æ–≤ –≤ BotFactory Runtime

## üìã API –¥–ª—è —É–ø—Ä–∞–≤–ª–µ–Ω–∏—è –±–æ—Ç–∞–º–∏

### 1. –°–æ–∑–¥–∞–Ω–∏–µ –Ω–æ–≤–æ–≥–æ –±–æ—Ç–∞

```bash
curl -X POST 'http://localhost:8000/bots' \
  -H 'Content-Type: application/json' \
  -d '{
    "name": "MyAwesomeBot",
    "token": "YOUR_BOT_TOKEN_FROM_BOTFATHER"
  }'
```

**–û—Ç–≤–µ—Ç:**
```json
{
  "bot_id": "uuid-–≥–µ–Ω–µ—Ä–∏—Ä—É–µ—Ç—Å—è-–∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏",
  "name": "MyAwesomeBot",
  "status": "active"
}
```

### 2. –î–æ–±–∞–≤–ª–µ–Ω–∏–µ —Å–ø–µ—Ü–∏—Ñ–∏–∫–∞—Ü–∏–∏ (flows –∏ –∫–æ–º–∞–Ω–¥)

```bash
curl -X PUT 'http://localhost:8000/bots/{bot_id}/spec' \
  -H 'Content-Type: application/json' \
  -d '{
    "flows": [
      {
        "steps": [
          {
            "reply": "–ü—Ä–∏–≤–µ—Ç! –Ø –≤–∞—à –Ω–æ–≤—ã–π –±–æ—Ç!"
          }
        ],
        "entry_cmd": "/start"
      }
    ]
  }'
```

### 3. –ù–∞—Å—Ç—Ä–æ–π–∫–∞ webhook

```bash
curl -X POST "https://api.telegram.org/bot{YOUR_TOKEN}/setWebhook" \
  -H "Content-Type: application/json" \
  -d '{
    "url": "https://your-domain.com/tg/{bot_id}"
  }'
```

## üîß –§–æ—Ä–º–∞—Ç —Å–ø–µ—Ü–∏—Ñ–∏–∫–∞—Ü–∏–∏ –±–æ—Ç–∞

### –ë–∞–∑–æ–≤–∞—è —Å—Ç—Ä—É–∫—Ç—É—Ä–∞ flows

```json
{
  "flows": [
    {
      "entry_cmd": "/command_name",
      "steps": [
        {
          "reply": "–¢–µ–∫—Å—Ç –æ—Ç–≤–µ—Ç–∞ –±–æ—Ç–∞"
        }
      ]
    }
  ]
}
```

### –ü—Ä–∏–º–µ—Ä—ã –∫–æ–º–∞–Ω–¥

#### –ü—Ä–æ—Å—Ç–∞—è –∫–æ–º–∞–Ω–¥–∞
```json
{
  "entry_cmd": "/start",
  "steps": [
    {
      "reply": "üéâ –î–æ–±—Ä–æ –ø–æ–∂–∞–ª–æ–≤–∞—Ç—å! –Ø –≥–æ—Ç–æ–≤ –∫ —Ä–∞–±–æ—Ç–µ."
    }
  ]
}
```

#### –ö–æ–º–∞–Ω–¥–∞ –ø–æ–º–æ—â–∏
```json
{
  "entry_cmd": "/help",
  "steps": [
    {
      "reply": "üìö –î–æ—Å—Ç—É–ø–Ω—ã–µ –∫–æ–º–∞–Ω–¥—ã:\n\n/start - –ù–∞—á–∞—Ç—å\n/help - –ü–æ–º–æ—â—å\n/status - –°—Ç–∞—Ç—É—Å"
    }
  ]
}
```

#### –ö–æ–º–∞–Ω–¥–∞ —Å—Ç–∞—Ç—É—Å–∞
```json
{
  "entry_cmd": "/status",
  "steps": [
    {
      "reply": "üìä –°—Ç–∞—Ç—É—Å –±–æ—Ç–∞:\n\n‚úÖ –°–∏—Å—Ç–µ–º–∞ —Ä–∞–±–æ—Ç–∞–µ—Ç\n‚úÖ –ö–æ–º–∞–Ω–¥—ã –æ–±—Ä–∞–±–∞—Ç—ã–≤–∞—é—Ç—Å—è\n‚úÖ –í—Å—ë –≤ –ø–æ—Ä—è–¥–∫–µ!"
    }
  ]
}
```

## üöÄ –ü–æ–ª–Ω—ã–π –ø—Ä–∏–º–µ—Ä —Å–æ–∑–¥–∞–Ω–∏—è –±–æ—Ç–∞

### –®–∞–≥ 1: –°–æ–∑–¥–∞–Ω–∏–µ –±–æ—Ç–∞
```bash
# –°–æ–∑–¥–∞–µ–º –±–æ—Ç–∞
RESPONSE=$(curl -s -X POST 'http://localhost:8000/bots' \
  -H 'Content-Type: application/json' \
  -d '{"name": "TestBot", "token": "YOUR_BOT_TOKEN"}')

# –ò–∑–≤–ª–µ–∫–∞–µ–º bot_id
BOT_ID=$(echo $RESPONSE | jq -r '.bot_id')
echo "Bot ID: $BOT_ID"
```

### –®–∞–≥ 2: –î–æ–±–∞–≤–ª–µ–Ω–∏–µ —Ñ—É–Ω–∫—Ü–∏–æ–Ω–∞–ª—å–Ω–æ—Å—Ç–∏
```bash
# –î–æ–±–∞–≤–ª—è–µ–º commands
curl -X PUT "http://localhost:8000/bots/$BOT_ID/spec" \
  -H 'Content-Type: application/json' \
  -d '{
    "flows": [
      {
        "entry_cmd": "/start",
        "steps": [{"reply": "üéâ –ü—Ä–∏–≤–µ—Ç! –Ø –≤–∞—à –Ω–æ–≤—ã–π –±–æ—Ç!"}]
      },
      {
        "entry_cmd": "/help",
        "steps": [{"reply": "üìö –ö–æ–º–∞–Ω–¥—ã: /start, /help, /about"}]
      },
      {
        "entry_cmd": "/about",
        "steps": [{"reply": "ü§ñ –Ø —Å–æ–∑–¥–∞–Ω —Å –ø–æ–º–æ—â—å—é BotFactory Runtime!"}]
      }
    ]
  }'
```

### –®–∞–≥ 3: –ù–∞—Å—Ç—Ä–æ–π–∫–∞ webhook
```bash
# –ù–∞—Å—Ç—Ä–∞–∏–≤–∞–µ–º webhook (–¥–ª—è production)
curl -X POST "https://api.telegram.org/bot$YOUR_TOKEN/setWebhook" \
  -H "Content-Type: application/json" \
  -d "{\"url\": \"https://your-domain.com/tg/$BOT_ID\"}"
```

## ‚ö° –û—Å–æ–±–µ–Ω–Ω–æ—Å—Ç–∏ —Å–∏—Å—Ç–µ–º—ã

### ‚úÖ –ß—Ç–æ —Ä–∞–±–æ—Ç–∞–µ—Ç:
- **Hot reload** - –∏–∑–º–µ–Ω–µ–Ω–∏—è –ø—Ä–∏–º–µ–Ω—è—é—Ç—Å—è –º–≥–Ω–æ–≤–µ–Ω–Ω–æ
- **–ú—É–ª—å—Ç–∏—Ç–µ–Ω–∞–Ω—Ç–Ω–æ—Å—Ç—å** - –º–Ω–æ–∂–µ—Å—Ç–≤–µ–Ω–Ω—ã–µ –±–æ—Ç—ã —Ä–∞–±–æ—Ç–∞—é—Ç –ø–∞—Ä–∞–ª–ª–µ–ª—å–Ω–æ
- **–ù–µ–∑–∞–≤–∏—Å–∏–º–æ—Å—Ç—å** - –∫–∞–∂–¥—ã–π –±–æ—Ç –∏–º–µ–µ—Ç —Å–≤–æ—é –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—é
- **–ú–∞—Å—à—Ç–∞–±–∏—Ä—É–µ–º–æ—Å—Ç—å** - –Ω–µ–æ–≥—Ä–∞–Ω–∏—á–µ–Ω–Ω–æ–µ –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ –±–æ—Ç–æ–≤

### üîß –¢–µ—Ö–Ω–∏—á–µ—Å–∫–∏–µ –¥–µ—Ç–∞–ª–∏:
- –ö–∞–∂–¥—ã–π –±–æ—Ç –ø–æ–ª—É—á–∞–µ—Ç —É–Ω–∏–∫–∞–ª—å–Ω—ã–π `bot_id` (UUID)
- Webhook endpoint: `/tg/{bot_id}`
- –°–ø–µ—Ü–∏—Ñ–∏–∫–∞—Ü–∏–∏ —Ö—Ä–∞–Ω—è—Ç—Å—è –≤ PostgreSQL
- Router —Å—Ç—Ä–æ–∏—Ç—Å—è –¥–∏–Ω–∞–º–∏—á–µ—Å–∫–∏ –¥–ª—è –∫–∞–∂–¥–æ–≥–æ –∑–∞–ø—Ä–æ—Å–∞

### üìù –ü—Ä–∞–≤–∏–ª–∞ –Ω–∞–ø–∏—Å–∞–Ω–∏—è flows:
1. **entry_cmd** –¥–æ–ª–∂–Ω–æ –Ω–∞—á–∏–Ω–∞—Ç—å—Å—è —Å `/`
2. **steps** —Å–æ–¥–µ—Ä–∂–∏—Ç –º–∞—Å—Å–∏–≤ —à–∞–≥–æ–≤
3. **reply** - —Ç–µ–∫—Å—Ç –æ—Ç–≤–µ—Ç–∞ –±–æ—Ç–∞
4. –ü–æ–¥–¥–µ—Ä–∂–∏–≤–∞—é—Ç—Å—è —ç–º–æ–¥–∑–∏ –∏ markdown
5. –î–ª–∏–Ω–Ω—ã–µ —Å–æ–æ–±—â–µ–Ω–∏—è –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ —Ñ–æ—Ä–º–∞—Ç–∏—Ä—É—é—Ç—Å—è

## üõ†Ô∏è API Endpoints

| –ú–µ—Ç–æ–¥ | Endpoint | –û–ø–∏—Å–∞–Ω–∏–µ |
|-------|----------|----------|
| `POST` | `/bots` | –°–æ–∑–¥–∞—Ç—å –Ω–æ–≤–æ–≥–æ –±–æ—Ç–∞ |
| `PUT` | `/bots/{id}/spec` | –û–±–Ω–æ–≤–∏—Ç—å —Å–ø–µ—Ü–∏—Ñ–∏–∫–∞—Ü–∏—é |
| `GET` | `/bots/{id}` | –ü–æ–ª—É—á–∏—Ç—å –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—é –æ –±–æ—Ç–µ |
| `POST` | `/bots/{id}/reload` | –ü–µ—Ä–µ–∑–∞–≥—Ä—É–∑–∏—Ç—å –∫—ç—à –±–æ—Ç–∞ |
| `POST` | `/tg/{id}` | Webhook endpoint –¥–ª—è Telegram |

## üéØ –ë—ã—Å—Ç—Ä—ã–π —Å—Ç–∞—Ä—Ç

```bash
# 1. –°–æ–∑–¥–∞—Ç—å –±–æ—Ç–∞ –≤ @BotFather –∏ –ø–æ–ª—É—á–∏—Ç—å —Ç–æ–∫–µ–Ω
# 2. –°–æ–∑–¥–∞—Ç—å –≤ —Å–∏—Å—Ç–µ–º–µ:
curl -X POST 'http://localhost:8000/bots' -H 'Content-Type: application/json' \
  -d '{"name": "QuickBot", "token": "YOUR_TOKEN"}'

# 3. –î–æ–±–∞–≤–∏—Ç—å –±–∞–∑–æ–≤—ã–µ –∫–æ–º–∞–Ω–¥—ã:
curl -X PUT 'http://localhost:8000/bots/BOT_ID/spec' -H 'Content-Type: application/json' \
  -d '{"flows": [{"entry_cmd": "/start", "steps": [{"reply": "–ü—Ä–∏–≤–µ—Ç! üëã"}]}]}'

# 4. –ù–∞—Å—Ç—Ä–æ–∏—Ç—å webhook –∏ –Ω–∞—á–∞—Ç—å –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å!
```

üéâ **–ì–æ—Ç–æ–≤–æ! –í–∞—à –±–æ—Ç —Ä–∞–±–æ—Ç–∞–µ—Ç –∏ –æ—Ç–≤–µ—á–∞–µ—Ç –Ω–∞ –∫–æ–º–∞–Ω–¥—ã!**